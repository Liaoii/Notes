## 10. 分页插件

### 10.1 环境搭建

添加依赖：

```xml
<dependencies>
    <dependency>
        <groupId>com.github.pagehelper</groupId>
        <artifactId>pagehelper</artifactId>
        <version>5.1.4</version>
    </dependency>
</dependencies>
```

在MyBatis全局配置文件中添加配置：

```xml
<plugins>
    <plugin interceptor="com.github.pagehelper.PageInterceptor"></plugin>
</plugins>
```

### 10.2 测试

**PageHelperTest**：

```java
public class PageHelperTest {
    @Test
    public void test01() {
        SqlSession session = SqlSessionUtil.getSqlSession();
        EmpMapper mapper = session.getMapper(EmpMapper.class);
        Page page = PageHelper.startPage(2,5);
        List<Emp> list = mapper.selectByExample(null);
        list.forEach(System.out::println);
    }
}
```

**结果**：

```
DEBUG 07-04 20:04:33,102 Cache Hit Ratio [SQL_CACHE]: 0.0 (LoggingCache.java:60) 
DEBUG 07-04 20:04:33,159 ==>  Preparing: SELECT count(0) FROM t_emp (BaseJdbcLogger.java:137) 
DEBUG 07-04 20:04:33,195 ==> Parameters:  (BaseJdbcLogger.java:137) 
DEBUG 07-04 20:04:33,217 <==      Total: 1 (BaseJdbcLogger.java:137) 
DEBUG 07-04 20:04:33,221 ==>  Preparing: select eid, emp_name, age, sex, email, did from t_emp LIMIT ?, ? (BaseJdbcLogger.java:137) 
DEBUG 07-04 20:04:33,222 ==> Parameters: 5(Integer), 5(Integer) (BaseJdbcLogger.java:137) 
DEBUG 07-04 20:04:33,225 <==      Total: 4 (BaseJdbcLogger.java:137) 
Emp{eid=11, empName='aa', age=18, sex='女', email='aa@qq.com', did=null}
Emp{eid=12, empName='bb', age=18, sex='女', email='bb@qq.com', did=null}
Emp{eid=13, empName='cc', age=18, sex='女', email='cc@qq.com', did=null}
Emp{eid=14, empName='呜呜', age=20, sex='男', email='323@qq.com', did=1}
```



```java
public class PageHelperTest {
    @Test
    public void test01() {
        SqlSession session = SqlSessionUtil.getSqlSession();
        EmpMapper mapper = session.getMapper(EmpMapper.class);
        //Page<Object> page = PageHelper.startPage(2,5);
        PageHelper.startPage(2,5);
        List<Emp> list = mapper.selectByExample(null);
        PageInfo<Emp> page = new PageInfo<>(list, 5);
        //list.forEach(System.out::println);
        System.out.println(page);
    }
}
```

**PageInfo**：

```
PageInfo{
	pageNum=2, 
	pageSize=5, 
	size=4, 
	startRow=6, 
	endRow=9, 
	total=9, 
	pages=2, 
	list=Page{
		count=true, 
		pageNum=2, 
		pageSize=5, 
		startRow=5, 
		endRow=10, 
		total=9, 
		pages=2, 
		reasonable=false, 
		pageSizeZero=false
	}
	[
		Emp{eid=11, empName='aa', age=18, sex='女', email='aa@qq.com', did=null}, 
		Emp{eid=12, empName='bb', age=18, sex='女', email='bb@qq.com', did=null}, 
		Emp{eid=13, empName='cc', age=18, sex='女', email='cc@qq.com', did=null}, 
		Emp{eid=14, empName='呜呜', age=20, sex='男', email='323@qq.com', did=1}
	], 
	prePage=1, 
	nextPage=0, 
	isFirstPage=false, 
	isLastPage=true, 
	hasPreviousPage=true, 
	hasNextPage=false, 
	navigatePages=5, 
	navigateFirstPage=1, 
	navigateLastPage=2, 
	navigatepageNums=[1, 2]
}
```

limit index, pageSize

index：当前页的起始索引

pageSize：每页显示的条数

pageNum：当前页的页码

index = （pageNum - 1）* pageSize



使用MyBatis的分页插件实现分页功能：

需要在查询功能之前开启分页：PageHelper.startPage(2,5);

在查询功能之后获取分页相关信息：PageInfo<Emp> page = new PageInfo<>(list, 5); list表示分页数据，5表示当前导航分页的数量